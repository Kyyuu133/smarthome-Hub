<!DOCTYPE html>
<html>
<head>
    <title>Smart Home - Current Device States</title>
    <link rel="stylesheet" href="/static/style.css">
</head>
<body>
    <h1>ğŸ“± Current Device States</h1>
    
    <div class="navigation-links">
        <a href="/status/events/all_devices">Refresh</a>
        <a href="/status/events">â† Status Overview</a>
        <a href="/list">â† Rooms</a>
        <a href="/dashboard">ğŸ“Š Dashboard</a>
    </div>

    {% if events %}
        <!-- Lamps Table -->
        <h2>ğŸ’¡ Lamps</h2>
        {% set lamps = events | selectattr("device_type", "equalto", "Lamp") | list %}
        {% if lamps %}
        <table>
            <thead>
                <tr>
                    <th>Device ID</th>
                    <th>Status</th>
                    <th>Name</th>
                    <th>Brightness (%)</th>
                    <th>Timestamp</th>
                    <th>History</th>
                </tr>
            </thead>
            <tbody>
                {% for e in lamps %}
                <tr>
                    <td>{{ e["device_id"] }}</td>
                    <td>{{ "âœ…" if e["device_status"] else "âŒ" }}</td>
                    <td>{{ e["device_name"] }}</td>
                    <td>{{ e["brightness_value"] }}</td>
                    <td>{{ e["event_timestamp"] }}</td>
                    <td><a href="/status/events/device/history/{{ e['device_id'] }}">View History</a></td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
        {% else %}
        <p>No lamps found.</p>
        {% endif %}

        <!-- Heaters Table -->
        <h2>ğŸ”¥ Heaters</h2>
        {% set heaters = events | selectattr("device_type", "equalto", "Heater") | list %}
        {% if heaters %}
        <table>
            <thead>
                <tr>
                    <th>Device ID</th>
                    <th>Status</th>
                    <th>Name</th>
                    <th>Temp (Â°C)</th>
                    <th>Timestamp</th>
                    <th>History</th>
                </tr>
            </thead>
            <tbody>
                {% for e in heaters %}
                <tr>
                    <td>{{ e["device_id"] }}</td>
                    <td>{{ "âœ…" if e["device_status"] else "âŒ" }}</td>
                    <td>{{ e["device_name"] }}</td>
                    <td>{{ e["temp_value"] }}</td>
                    <td>{{ e["event_timestamp"] }}</td>
                    <td><a href="/status/events/device/history/{{ e['device_id'] }}">View History</a></td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
        {% else %}
        <p>No heaters found.</p>
        {% endif %}

    {% else %}
    <div class="no-data">
        <p>No events found.</p>
    </div>
    {% endif %}
</body>
</html>
